#pragma once 

#include "Window.h"
#include "GLSLShader.h"
#include "Net.h"
#include "Camera.h"
#include "TexturedQuad.h"


class Game : public Window {
public:
	void setupAndStart();
private:	
	thread t;
	bool shouldRender = false;
	atomic<bool> done = false;

	// Global Matrices Uniform Buffer Object and Binding Index
	GLuint globalMatricesUBO;
	GLuint globalMatricesUBI;

	// Texture Binding Unit
	GLuint texBindingUnit;

	GLSLShader shader, normalsShader, textureShader;

	glm::mat4 perspectiveMatrix;
	CameraPtr camera = CameraPtr(new FreeLookCamera());

	unsigned int debugCounter = 0;
	shared_ptr<Net> ground;

	TexturedQuad texturedQuad;

	GLuint textureBufferObject;
	GLuint texDataBufferObject, texTriangleIndexBuffer, texVao;
	GLuint texSampler;

	void myRenderFunction();
	void render();
	void loadShaders();
	void setGlobalMatrices();
	void prepareTextureStuff();
	void setTextureStuff();

	void initStuff();
	void startThread();
	void threadStuff();
};